# Lab 9-2
The only strings of note are the imports and cmd.

Nothing seems to happen if we run the program.
First, we'll find the main entry point in IDA, which is in 0x00401128.
On entry to the function, we can see multiple mov instructions of values into 2 continous blocks of data separated by NULL. To find the strings, we we right-click EBP in the register window and choose 'follow in dump'. As we step through the instructions, we can see the strings iqaz2wsx3edc and ocl.exe form.
After the creation of the strings, the program gets the name of the executable and stores it. It then compares it to ocl.exe and continues only if they are equal. As such, to get the malware to run its malicious payload we need to change the executables name to ocl.exe.

The string iqaz2wsx3edc and a pointer to a buffer of data are passed into the subroutine.
The subroutine decodes the string www.practicalmalwareanalysis.com by XOR-ing the encoded DNS name with the string iqaz2wsx3edc.

The program sets the stdout, stdin and stderr to the socket when it creates the CMD process with the call at 0x0040106E. Thus, the victim machine creates a shell session (that is also not visible to the user by creating it with argument wShowWindow as 0) that receives input from the socket and sends output to the socket.