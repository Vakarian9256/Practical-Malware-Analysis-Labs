# Lab 6-3
The subroutines at 0x401000 & 0x401040 are the same as in lab 2. subroutine 0x401271 is printf. The subroutine at 0x401330 is new to this lab.

The new subroutine takes 2 arguments. The 1st argument is the command character from the HTML comment, and the 2nd is argv[0] - the name of the program.
The function contains a switch statement with a jump table.
The function can either create a directory at C:\\Temp, copy or delete a file named C:\\Temp\\cc.exe, set a registry key to write the file into persistence, sleep for 100 seconds or print error messages.

The existence of the file C:\\Temp\\cc.exe and of registry key Software\Microsoft\Windows\CurrentVersion\Run\Malware can be used as host-based indicators for this malware.

The program first checks for an internet connection. If none exists, it terminates. Else it tries to download a web-page located at http://www.practicalmalwareanalysis.com/cc.html. It then parses an HTML command beginning with < !--. The first character following the sequence is parsed and used in a switch statement which can either create the directory C:\\Temp, copy or delete a file named C:\\Temp\\cc.exe, set a registry run key  - Software\Microsoft\Windows\CurrentVersion\Run\Malware,
or sleep for 100 seconds.