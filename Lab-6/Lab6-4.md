# Lab 6-4
The calls stayed the same: the function at 0x401000 checks the internet connection, the function at 0x401040 parses the HTML comment, the function at 0x4012B5 is printf and the function at 0x401150 is the switch statement.

The program now has a for loop statement which parses an HTML comment and performs the switch statement function on it.

The parse HTML function at 0x401040 takes an integer as a parameter and creates a User-Agent using sprintf in the format "Internet Explorer 7.50/pma%d", where %d is replaced with the value of the argument, to use during the HTTP communication.

The for loop in the program runs for 1440 iterations. In each iteration, the Sleep function is called for 60 seconds. As such, the program will run for at least 1440 minutes - 24 hours.

The new network-based indicator for this program is the new User-Agent is used. It takes the form of "Internet Explorer 7.50/pma%d". As we learned, the number of iterations is equal to the number of minutes that the program has been running for. That same number is used as the argument for the parse-HTML function. As such %d notes the number of minutes the program has been running for.

In conclusion, the program checks for an internet connection. If none exist, it will terminate. Else, the program will try to download a web-page located at http://www.practicalmalwareanalysis.com/cc.html using a User-Agent which holds a counter for the number of minutes the program has been running for. It will then parse an HTML comment starting with <!--. The program parses the first character following that sequence and uses it in a switch statement to perform one of the following actions: Create a directory C:\\Temp, copy or delete a file called C:\\Temp\\cc.exe, set a registry run key Software\Microsoft\Windows\CurrentVersion\Run\Malware or sleep for 100 seconds. After 24 hours, the program terminates.

