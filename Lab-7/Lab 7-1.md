# Lab 7-1
The program creates a service called MalService with the start value of AUTO_START to achieve persistence.

The program uses a mutex to ensure only one copy of the program can be ran at any given time. This mutex, named HGL345, along with the service MalService, can be used as host-based indicators to detect this malware.

As for network-based indicators, there are 2: the program connects to http://www.malwareanalysisbook.com using the User-Agent Internet Explorer 8.0.

We can see several calls to API that are related to date and timers.
The program calls CreateWaitableTimer to set a timer for a certain date. The program sets the date to 1/1/2100 00:00:00.
The program then calls WaitForSingleObject and waits until the specified object is in the signaled state or the time-out interval elapses. In this case, it either waits until the date is 1/1/2100 00:00:00 or until 49.71 days have passed.
If the timer elapses, it will sleep for another 49.71 days and exit the function.
Otherwise, the program creates 20 threads, with each one sending requests to http://www.malwareanalysisbook.com over and over again in an endless loop, as sort of a DDoS attack against the site.

While the malware can end execution after 100 days if far enough away from the year 2100, it has written itself into persistence, and as such it will eventually reach to the desired date. After which, the program will never stop running, as each thread runs on an endless loop.